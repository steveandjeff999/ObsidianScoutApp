# Visual Flow Diagrams

## Auto-Load Matches Flow

```
???????????????????????????????????????????????????????????????
?                    USER SELECTS TEAM                         ?
???????????????????????????????????????????????????????????????
                       ?
                       ?
         ???????????????????????????
         ? OnSelectedTeamChanged() ?
         ?   TeamId = value.Id     ?
         ?   _ = AutoLoad()        ?  ? Fire and forget
         ???????????????????????????
                      ?
                      ?
         ???????????????????????????
         ?  AutoLoadMatchesAsync() ?  ? Background task
         ???????????????????????????
                      ?
                      ?
         ???????????????????????????
         ?   Has GameConfig?       ?
         ???????????????????????????
              ? NO             ? YES
              ?                ?
          ?????????    ????????????????????
          ? Abort ?    ? Has EventCode?   ?
          ?????????    ????????????????????
                            ? NO     ? YES
                            ?        ?
                        ?????????  ????????????????????
                        ? Abort ?  ? Load from Server ?
                        ?????????  ????????????????????
                                        ?        ?
                                  SUCCESS?        ?FAIL
                                        ?        ?
                                        ?        ?
                              ????????????????  ???????????????????
                              ? Cache Matches?  ? Load from Cache ?
                              ? Populate UI  ?  ???????????????????
                              ????????????????       ?        ?
                                                     ?FOUND   ?NOT FOUND
                                                     ?        ?
                                          ????????????????  ??????????????
                                          ? Populate UI  ?  ? Empty List ?
                                          ????????????????  ??????????????
```

---

## Game Config Caching Flow

```
???????????????????????????????????????????????????????????????
?                      APP STARTS                              ?
???????????????????????????????????????????????????????????????
                       ?
                       ?
         ???????????????????????????
         ? LoadGameConfigAsync()   ?
         ???????????????????????????
                      ?
                      ?
         ???????????????????????????
         ? Try Load from Server    ?
         ???????????????????????????
              ?                ?
        SUCCESS?                ?FAIL
              ?                ?
              ?                ?
????????????????????????  ????????????????????????
? Server Returned Data ?  ? Try Load from Cache  ?
????????????????????????  ????????????????????????
       ?                        ?            ?
       ?                  FOUND ?            ? NOT FOUND
????????????????????            ?            ?
? Cache New Config ?            ?            ?
? IsOfflineMode=F  ?            ?    ?????????????????
? Load Elements    ?            ?    ? Show Error    ?
? Initialize Form  ?            ?    ? Cannot Start  ?
????????????????????            ?    ?????????????????
                                ?
                     ??????????????????????????
                     ? Use Cached Config      ?
                     ? IsOfflineMode=TRUE     ?
                     ? Show "Offline" Warning ?
                     ? Load Elements          ?
                     ? Initialize Form        ?
                     ??????????????????????????
```

---

## Match Caching Flow

```
???????????????????????????????????????????????????????????????
?          USER CLICKS "LOAD MATCHES" (Manual)                 ?
???????????????????????????????????????????????????????????????
                       ?
                       ?
         ???????????????????????????
         ? LoadMatchesAsync()      ?  ? Shows loading spinner
         ???????????????????????????
                      ?
                      ?
         ???????????????????????????
         ? Get Event from Server   ?
         ???????????????????????????
              ?                ?
        SUCCESS?                ?FAIL
              ?                ?
              ?                ?
????????????????????????  ????????????????????????
? Get Matches for      ?  ? Try Load from Cache  ?
? Event from Server    ?  ????????????????????????
????????????????????????       ?            ?
       ?                 FOUND ?            ? NOT FOUND
SUCCESS?                       ?            ?
       ?                       ?            ?
????????????????????  ???????????????????  ????????????????
? Cache Matches    ?  ? Use Cache       ?  ? Show Error   ?
? Populate Dropdown?  ? Populate        ?  ? No Matches   ?
? Show Success     ?  ? Show "Offline"  ?  ????????????????
????????????????????  ???????????????????
```

---

## Offline Scenario (Complete Flow)

```
                    ???????????????????
                    ?   USER OFFLINE  ?
                    ?  (No Internet)  ?
                    ???????????????????
                             ?
                             ?
           ????????????????????????????????????
           ?   1. App Starts                   ?
           ?   ? LoadGameConfigAsync()         ?
           ????????????????????????????????????
                    ?
                    ? (Server fails)
           ????????????????????????????????????
           ?   2. Load Config from Cache       ?
           ?   ? GameConfig restored           ?
           ?   ? IsOfflineMode = true          ?
           ?   ? Show "?? Offline Mode"        ?
           ????????????????????????????????????
                    ?
                    ?
           ????????????????????????????????????
           ?   3. User Selects Team            ?
           ?   ? AutoLoadMatchesAsync()        ?
           ????????????????????????????????????
                    ?
                    ? (Server fails)
           ????????????????????????????????????
           ?   4. Load Matches from Cache      ?
           ?   ? Matches restored              ?
           ?   ? Dropdown populated            ?
           ????????????????????????????????????
                    ?
                    ?
           ????????????????????????????????????
           ?   5. User Scouts Match            ?
           ?   ? Fill form                     ?
           ?   ? Generate QR Code ?            ?
           ?   ? Submit to Server ? (offline)  ?
           ?????????????????????????????????????
```

---

## Data Flow Architecture

```
??????????????????????????????????????????????????????????????????
?                        MOBILE APP                               ?
?                                                                  ?
?  ????????????????      ????????????????      ???????????????? ?
?  ?              ?      ?              ?      ?              ? ?
?  ?  ViewModel   ???????? SecureStorage????????  API Service ? ?
?  ?              ?      ?   (Cache)    ?      ?              ? ?
?  ????????????????      ????????????????      ???????????????? ?
?         ?                                            ?          ?
?         ? Bind UI                          HTTP     ?          ?
?         ?                                            ?          ?
?  ????????????????                          ????????????????   ?
?  ?     View     ?                          ?   Network    ?   ?
?  ?   (XAML)     ?                          ????????????????   ?
?  ????????????????                                 ?           ?
??????????????????????????????????????????????????????????????????
                                                     ?
                                                     ?
                                          ????????????????????
                                          ?  SERVER API      ?
                                          ?  (Flask/Python)  ?
                                          ????????????????????
```

### Data Sources Priority:
1. **Primary**: Server API (always try first)
2. **Fallback**: SecureStorage Cache (use when server unavailable)
3. **Last Resort**: Show error (no server, no cache)

---

## Cache Lifecycle

```
???????????????????????????????????????????????????????????????
?                    CACHE LIFECYCLE                           ?
???????????????????????????????????????????????????????????????

First Run (Online):
?????????????????????
Server Data ? Cache ? Use Data
                ?
         Set Timestamp

Subsequent Run (Online):
????????????????????????
Server Data ? Update Cache ? Use New Data
                ?
         Update Timestamp

Offline Run:
????????????
Try Server (Fail) ? Load Cache ? Use Cached Data
                                        ?
                                 Check Age (log)

Cache Update Triggers:
??????????????????????
1. Successful server load (automatic)
2. Manual refresh button (user action)
3. App restart (tries server first)

Cache Never Cleared:
????????????????????
- Persists across app restarts
- Survives device reboots
- Only overwritten when new data loaded
```

---

## Error Handling Flow

```
                    ???????????????????
                    ?  API Call Made  ?
                    ???????????????????
                             ?
                    ???????????????????
                    ?   Try Server    ?
                    ???????????????????
                         ?          ?
                   SUCCESS?          ?FAIL
                         ?          ?
                         ?          ?
              ????????????????  ????????????????
              ? Cache Result ?  ? Catch Error  ?
              ? Return Data  ?  ????????????????
              ????????????????         ?
                                       ?
                              ???????????????????
                              ? Try Load Cache  ?
                              ???????????????????
                                   ?          ?
                             FOUND ?          ? NOT FOUND
                                   ?          ?
                                   ?          ?
                        ????????????????  ????????????????
                        ? Return Cache ?  ? Return Error ?
                        ? Log Warning  ?  ? Log Error    ?
                        ????????????????  ????????????????
```

---

## State Machine: Offline Mode

```
           ???????????????????????????
           ?   INITIAL (Unknown)     ?
           ???????????????????????????
                      ?
         ???????????????????????????
         ?  Try Load from Server   ?
         ???????????????????????????
              ?                ?
        SUCCESS?                ?FAIL
              ?                ?
              ?                ?
    ????????????????????  ????????????????????
    ?  ONLINE MODE     ?  ?  Try Load Cache  ?
    ? IsOfflineMode=F  ?  ????????????????????
    ????????????????????       ?
            ?                  ? FOUND
            ?                  ?
            ?         ????????????????????
            ?         ?  OFFLINE MODE    ?
            ?         ? IsOfflineMode=T  ???????
            ?         ????????????????????     ?
            ?              ?                    ?
            ?              ? Any API Call       ?
            ?              ?                    ?
            ?       ???????????????            ?
            ?       ? Try Server  ?            ?
            ?       ???????????????            ?
            ?          ?        ?               ?
            ?    SUCCESS?        ?FAIL          ?
            ?          ?        ?????????????????
            ?          ?
            ????????????
         ????????????????????
         ?  ONLINE MODE     ?
         ? IsOfflineMode=F  ?
         ????????????????????
```

---

## Legend

**Symbols:**
- `?` : Data flow / Function call
- `?` : Next step / Progression
- `?` : Feedback loop
- `???` : Process / State
- `?` : Successful operation
- `?` : Failed operation

**Terms:**
- **Cache**: Local secure storage
- **Server**: Remote API endpoint
- **Offline Mode**: Using cached data (no server connection)
- **Online Mode**: Connected to server, using live data
- **Fire-and-forget**: Async operation that doesn't block UI

---

These diagrams illustrate the complete flow of data through the application, showing how automatic loading and caching work together to provide a seamless offline-first experience.
