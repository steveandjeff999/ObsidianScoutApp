<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:shapes="clr-namespace:Microsoft.Maui.Controls.Shapes;assembly=Microsoft.Maui.Controls"
    xmlns:viewmodels="clr-namespace:ObsidianScout.ViewModels"
    x:Class="ObsidianScout.MainPage"
    x:DataType="viewmodels:MainViewModel"
    Title="Home">

    <ScrollView>
   <VerticalStackLayout Padding="20" Spacing="20">

    <!-- Hero Section (rounded purple block) -->
    <Border Padding="0" Margin="0,0,0,4" Background="{AppThemeBinding Light={StaticResource PrimaryGradient}, Dark={StaticResource PrimaryGradientDark}}" Shadow="{StaticResource ShadowLg}">
      <Border.StrokeShape>
        <shapes:RoundRectangle CornerRadius="20" />
      </Border.StrokeShape>
      <VerticalStackLayout Padding="28" Spacing="18" HorizontalOptions="Fill" VerticalOptions="Center">
        <!-- Title in hero head (no badge) -->
        <HorizontalStackLayout HorizontalOptions="Center" VerticalOptions="Center">
          <Label Text="ObsidianScout" FontSize="34" FontFamily="OpenSansSemibold" FontAttributes="Bold" TextColor="White" HorizontalTextAlignment="Center" HorizontalOptions="Center" />
        </HorizontalStackLayout>

        <!-- Subtitle -->
        <Label Text="FRC Scouting Platform" FontSize="14" TextColor="White" Opacity="0.9" HorizontalTextAlignment="Center" HorizontalOptions="Center" />

        <!-- Compact stats row -->
        <Grid ColumnDefinitions="*,*,*" ColumnSpacing="12" IsVisible="{Binding CurrentUser, Converter={StaticResource IsNotNullConverter}}">
          <Frame Padding="10" CornerRadius="12" BackgroundColor="{AppThemeBinding Light=#40FFFFFF, Dark=#20FFFFFF}">
            <VerticalStackLayout Spacing="2" HorizontalOptions="Center">
              <Label Text="EVENT" FontSize="10" FontFamily="OpenSansSemibold" CharacterSpacing="1" TextColor="White" Opacity="0.8" HorizontalTextAlignment="Center" />
              <Label Text="{Binding CurrentEventName}" FontSize="13" FontFamily="OpenSansSemibold" TextColor="White" HorizontalTextAlignment="Center" LineBreakMode="TailTruncation" />
            </VerticalStackLayout>
          </Frame>

          <Frame Padding="10" CornerRadius="12" BackgroundColor="{AppThemeBinding Light=#40FFFFFF, Dark=#20FFFFFF}">
            <VerticalStackLayout Spacing="2" HorizontalOptions="Center">
              <Label Text="TEAMS" FontSize="10" FontFamily="OpenSansSemibold" CharacterSpacing="1" TextColor="White" Opacity="0.8" HorizontalTextAlignment="Center" />
              <Label Text="{Binding TeamCount}" FontSize="18" FontFamily="OpenSansSemibold" TextColor="White" HorizontalTextAlignment="Center" />
            </VerticalStackLayout>
          </Frame>

          <Frame Padding="10" CornerRadius="12" BackgroundColor="{AppThemeBinding Light=#40FFFFFF, Dark=#20FFFFFF}">
            <VerticalStackLayout Spacing="2" HorizontalOptions="Center">
              <Label Text="MATCHES" FontSize="10" FontFamily="OpenSansSemibold" CharacterSpacing="1" TextColor="White" Opacity="0.8" HorizontalTextAlignment="Center" />
              <Label Text="{Binding MatchCount}" FontSize="18" FontFamily="OpenSansSemibold" TextColor="White" HorizontalTextAlignment="Center" />
            </VerticalStackLayout>
          </Frame>
        </Grid>
      </VerticalStackLayout>
    </Border>

    <!-- Quick Actions Section -->
            <Label Text="QUICK ACTIONS"
          Style="{StaticResource SectionHeader}" />

    <!-- Server Sync - card styled like a primary button -->
    <Border
        HeightRequest="56"
        Padding="0"
        Margin="0,0,0,0"
        StrokeThickness="0"
        Shadow="{StaticResource ShadowSm}"
        Background="{AppThemeBinding Light={StaticResource PrimaryGradient}, Dark={StaticResource PrimaryGradientDark}}">

        <Border.StrokeShape>
            <shapes:RoundRectangle CornerRadius="12" />
        </Border.StrokeShape>

        <Border.GestureRecognizers>
            <TapGestureRecognizer Command="{Binding TriggerSyncCommand}" NumberOfTapsRequired="1" />
        </Border.GestureRecognizers>

        <Grid ColumnDefinitions="*,Auto" HorizontalOptions="Fill" VerticalOptions="Center">
            <!-- Centered label looks like a button -->
            <Label Grid.Column="0"
                   Text="Trigger Server Sync"
                   HorizontalTextAlignment="Center"
                   VerticalTextAlignment="Center"
                   FontFamily="OpenSansSemibold"
                   FontSize="16"
                   TextColor="White"
                   Padding="12,0" />

            <!-- Loading indicator on the right -->
            <HorizontalStackLayout Grid.Column="1" Padding="12,0" Spacing="8" VerticalOptions="Center">
                <ActivityIndicator IsRunning="{Binding IsLoading}" IsVisible="{Binding IsLoading}" Color="White" />
            </HorizontalStackLayout>
        </Grid>
    </Border>

 <!-- Action Cards Grid -->
         <Grid RowDefinitions="Auto,Auto" 
               ColumnDefinitions="*,*"
  RowSpacing="12"
     ColumnSpacing="12">

         <!-- Scout Match Card -->
       <Border Grid.Row="0" Grid.Column="0"
 Style="{StaticResource GlassCard}"
     Padding="16">
            <Border.GestureRecognizers>
        <TapGestureRecognizer Command="{Binding NavigateToScoutingCommand}" />
        </Border.GestureRecognizers>

        <VerticalStackLayout Spacing="12">
    <Border BackgroundColor="{AppThemeBinding Light={StaticResource LightPrimaryDark}, Dark={StaticResource DarkPrimaryDark}}"
            WidthRequest="48"
               HeightRequest="48"
        HorizontalOptions="Start">
       <Border.StrokeShape>
          <shapes:RoundRectangle CornerRadius="12" />
       </Border.StrokeShape>
       <Border.StrokeThickness>0</Border.StrokeThickness>
        <Image Source="{StaticResource IconClipboard}" WidthRequest="22" HeightRequest="22" HorizontalOptions="Center" VerticalOptions="Center" Aspect="AspectFit" />
         </Border>
         <VerticalStackLayout Spacing="4">
     <Label Text="Scout Match"
     Style="{StaticResource SubheaderLabel}"
        FontSize="16" />
        <Label Text="Record match data"
            Style="{StaticResource CaptionLabel}"
                 FontSize="12" />
    </VerticalStackLayout>
                </VerticalStackLayout>
                </Border>

          <!-- View Teams Card -->
      <Border Grid.Row="0" Grid.Column="1"
                  Style="{StaticResource GlassCard}"
          Padding="16">
         <Border.GestureRecognizers>
    <TapGestureRecognizer Command="{Binding NavigateToTeamsCommand}" />
      </Border.GestureRecognizers>

    <VerticalStackLayout Spacing="12">
    <Border BackgroundColor="{AppThemeBinding Light={StaticResource LightSecondary}, Dark={StaticResource DarkSecondary}}"
        WidthRequest="48"
            HeightRequest="48"
      HorizontalOptions="Start">
            <Border.StrokeShape>
 <shapes:RoundRectangle CornerRadius="12" />
          </Border.StrokeShape>
             <Border.StrokeThickness>0</Border.StrokeThickness>
           <Image Source="{StaticResource IconTeams}" WidthRequest="22" HeightRequest="22" HorizontalOptions="Center" VerticalOptions="Center" Aspect="AspectFit" />
     </Border>
       <VerticalStackLayout Spacing="4">
      <Label Text="Teams"
       Style="{StaticResource SubheaderLabel}"
         FontSize="16" />
   <Label Text="Browse team list"
      Style="{StaticResource CaptionLabel}"
       FontSize="12" />
               </VerticalStackLayout>
     </VerticalStackLayout>
        </Border>

    <!-- Events Card (Full Width) -->
        <Border Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2"
  Style="{StaticResource GlassCard}"
    Padding="16">
       <Border.GestureRecognizers>
             <TapGestureRecognizer Command="{Binding NavigateToEventsCommand}" />
      </Border.GestureRecognizers>

     <HorizontalStackLayout Spacing="16">
     <Border BackgroundColor="{AppThemeBinding Light={StaticResource LightTertiary}, Dark={StaticResource DarkTertiary}}"
    WidthRequest="48"
           HeightRequest="48"
   VerticalOptions="Center">
            <Border.StrokeShape>
              <shapes:RoundRectangle CornerRadius="12" />
            </Border.StrokeShape>
           <Border.StrokeThickness>0</Border.StrokeThickness>
   <Image Source="{StaticResource IconEvents}" WidthRequest="22" HeightRequest="22" HorizontalOptions="Center" VerticalOptions="Center" Aspect="AspectFit" />
  </Border>
     <VerticalStackLayout Spacing="4" VerticalOptions="Center">
   <Label Text="Events"
     Style="{StaticResource SubheaderLabel}"
          FontSize="17" />
               <Label Text="View competition events and schedules"
       Style="{StaticResource CaptionLabel}"
   FontSize="13" />
              </VerticalStackLayout>
         </HorizontalStackLayout>
       </Border>

      <!-- Graphs Card -->
      <Border Grid.Row="0" Grid.Column="1"
                  Style="{StaticResource GlassCard}"
          Padding="16"
          IsVisible="{Binding CurrentUser, Converter={StaticResource IsNotNullConverter}}">
         <Border.GestureRecognizers>
    <TapGestureRecognizer Command="{Binding NavigateToGraphsCommand}" />
      </Border.GestureRecognizers>

    <VerticalStackLayout Spacing="12">
    <Border BackgroundColor="{AppThemeBinding Light={StaticResource LightSecondary}, Dark={StaticResource DarkSecondary}}"
        WidthRequest="48"
            HeightRequest="48"
      HorizontalOptions="Start">
            <Border.StrokeShape>
 <shapes:RoundRectangle CornerRadius="12" />
          </Border.StrokeShape>
             <Border.StrokeThickness>0</Border.StrokeThickness>
           <Image Source="{StaticResource IconGraphs}" WidthRequest="22" HeightRequest="22" HorizontalOptions="Center" VerticalOptions="Center" Aspect="AspectFit" />
     </Border>
       <VerticalStackLayout Spacing="4">
      <Label Text="Graphs"
       Style="{StaticResource SubheaderLabel}"
         FontSize="16" />
   <Label Text="View offline analytics"
      Style="{StaticResource CaptionLabel}"
       FontSize="12" />
               </VerticalStackLayout>
     </VerticalStackLayout>
        </Border>
        </Grid>

    <!-- Navigation tip removed -->

   <!-- Bottom Spacing -->
            <BoxView HeightRequest="20" BackgroundColor="Transparent" />

        </VerticalStackLayout>
    </ScrollView>

</ContentPage>
